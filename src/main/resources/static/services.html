<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Services - Vehicle Service Booking</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <nav class="navbar">
        <div class="container" style="display: flex; justify-content: space-between; align-items: center;">
            <a href="/services.html" class="navbar-brand">Vehicle Service</a>
            <div class="nav-links">
                <a href="/services.html">Services</a>
                <a href="/book.html">Book Service</a>
                <a href="/history.html">History</a>
                <a href="/profile.html">Profile</a>
                <a href="#" onclick="logout()">Logout</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <h2>Available Services</h2>
        <div id="services-list" class="card">
            <!-- Services will be loaded here -->
        </div>
    </div>

    <script src="/js/session.js"></script>
    <script>
        // Hardcoded services since there's no /api/services endpoint
        const services = [
            {
                id: 1,
                name: "Oil Change",
                description: "Complete oil and filter change service for your vehicle.",
                price: 50,
                duration: 30,
                type: "OIL_CHANGE"
            },
            {
                id: 2,
                name: "Tire Rotation",
                description: "Rotate and balance your vehicle's tires for even wear.",
                price: 30,
                duration: 20,
                type: "TIRE_ROTATION"
            },
            {
                id: 3,
                name: "Brake Inspection",
                description: "Comprehensive brake system inspection and maintenance.",
                price: 40,
                duration: 25,
                type: "BRAKE_INSPECTION"
            }
        ];

        function loadServices() {
            const servicesList = document.getElementById('services-list');
            servicesList.innerHTML = services.map(service => `
                <div class="card" style="margin-bottom: 1rem;">
                    <h3>${service.name}</h3>
                    <p>${service.description}</p>
                    <p><strong>Price:</strong> $${service.price}</p>
                    <p><strong>Duration:</strong> ${service.duration} minutes</p>
                    <button class="btn btn-primary" onclick="bookService('${service.type}')">Book Now</button>
                </div>
            `).join('');
        }

        function bookService(serviceType) {
            // Pass the service type as a query param to book.html
            window.location.href = `/book.html?serviceType=${serviceType}`;
        }

        // Load services when page loads
        document.addEventListener('DOMContentLoaded', () => {
            checkSession().then(user => {
                if (!user || !user.roles || !user.roles.includes('ROLE_USER')) {
                    window.location.href = '/login.html';
                } else {
                    loadServices();
                }
            });
        });
    </script>
</body>
</html>